<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-scala-scraper----" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#scala-scraper----" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala Scraper <a href="https://travis-ci.org/ruippeixotog/scala-scraper" target="_blank"><img src="https://camo.githubusercontent.com/0b55699ce0abf8c4acb785c2557947416af8966d/68747470733a2f2f7472617669732d63692e6f72672f72756970706569786f746f672f7363616c612d736372617065722e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/ruippeixotog/scala-scraper.svg?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/github/ruippeixotog/scala-scraper?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/0f78b795d700c2d2aa172179d805637a4a383653/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f72756970706569786f746f672f7363616c612d736372617065722f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/ruippeixotog/scala-scraper/badge.svg?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/net.ruippeixotog/scala-scraper_2.11" target="_blank"><img src="https://camo.githubusercontent.com/832ecafe5e917a41d6203345ba68d7f20f9ac888/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f6e65742e72756970706569786f746f672f7363616c612d736372617065725f322e31312e737667" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/net.ruippeixotog/scala-scraper_2.11.svg" style="max-width:100%;"></a> <a href="https://gitter.im/ruippeixotog/scala-scraper" target="_blank"><img src="https://camo.githubusercontent.com/4ef9317892eea287893f7d3ef30ea2b9733ecd9f/68747470733a2f2f6261646765732e6769747465722e696d2f72756970706569786f746f672f7363616c612d736372617065722e737667" alt="Join the chat at https://gitter.im/ruippeixotog/scala-scraper" data-canonical-src="https://badges.gitter.im/ruippeixotog/scala-scraper.svg" style="max-width:100%;"></a></h1> 
  <p>A library providing a DSL for loading and extracting content from HTML pages.</p> 
  <p>Take a look at <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/test/scala/net/ruippeixotog/scalascraper/Examples.scala" target="_blank">Examples.scala</a> and at the <a href="https://github.com/ruippeixotog/scala-scraper/tree/master/src/test/scala/net/ruippeixotog/scalascraper" target="_blank">unit specs</a> for usage examples or keep reading for more thorough documentation. Feel free to use <a href="https://github.com/ruippeixotog/scala-scraper/issues" target="_blank">GitHub Issues</a> for submitting any bug or feature request and <a href="https://gitter.im/ruippeixotog/scala-scraper" target="_blank">Gitter</a> to ask questions.</p> 
  <h2><a id="user-content-quick-start" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#quick-start" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Quick Start</h2> 
  <p>To use Scala Scraper in an existing SBT project with Scala 2.11 or 2.12, add the following dependency to your <code>build.sbt</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>net.ruippeixotog<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>scala-scraper<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.2.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>If you are using an older version of this library, see this document for the version you're using: <a href="https://github.com/ruippeixotog/scala-scraper/blob/v0.1/README.md" target="_blank">0.1</a>, <a href="https://github.com/ruippeixotog/scala-scraper/blob/v0.1.1/README.md" target="_blank">0.1.1</a>, <a href="https://github.com/ruippeixotog/scala-scraper/blob/v0.1.2/README.md" target="_blank">0.1.2</a>.</p> 
  <p>An implementation of the <code>Browser</code> trait, such as <code>JsoupBrowser</code>, can be used to fetch HTML from the web or to parse a local HTML file or a string.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.ruippeixotog.scalascraper.browser.</span><span class="pl-v">JsoupBrowser</span>

<span class="pl-k">val</span> <span class="pl-en">browser</span> <span class="pl-k">=</span> <span class="pl-en">JsoupBrowser</span>()
<span class="pl-k">val</span> <span class="pl-en">doc</span> <span class="pl-k">=</span> browser.get(<span class="pl-s"><span class="pl-pds">"</span>http://example.com/<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">doc2</span> <span class="pl-k">=</span> browser.parseFile(<span class="pl-s"><span class="pl-pds">"</span>file.html<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>The returned object is a <code>Document</code>, which already provides several methods for manipulating and querying HTML elements. For simple use cases, it can be enough. For others, this library improves the content extracting process by providing a powerful DSL.</p> 
  <p>First of all, the DSL methods and conversions must be imported:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.ruippeixotog.scalascraper.dsl.DSL.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">net.ruippeixotog.scalascraper.dsl.DSL.Extract.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">net.ruippeixotog.scalascraper.dsl.DSL.Parse.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>Content can then be extracted using the <code>&gt;&gt;</code> extraction operator and CSS queries:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.ruippeixotog.scalascraper.model.</span><span class="pl-v">Element</span>

<span class="pl-c">// Extract the text inside the first h1 element</span>
<span class="pl-k">val</span> <span class="pl-en">title</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> doc <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>h1<span class="pl-pds">"</span></span>)

<span class="pl-c">// Extract the elements with class "item"</span>
<span class="pl-k">val</span> <span class="pl-en">items</span><span class="pl-k">:</span> <span class="pl-en">List</span>[<span class="pl-en">Element</span>] <span class="pl-k">=</span> doc <span class="pl-k">&gt;&gt;</span> elementList(<span class="pl-s"><span class="pl-pds">"</span>.item<span class="pl-pds">"</span></span>)

<span class="pl-c">// From each item, extract the text of the h3 element inside</span>
<span class="pl-k">val</span> <span class="pl-en">itemTitles</span><span class="pl-k">:</span> <span class="pl-en">List</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> items.map(_ <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>h3<span class="pl-pds">"</span></span>))

<span class="pl-c">// From the meta element with "viewport" as its attribute name, extract the</span>
<span class="pl-c">// text in the content attribute</span>
<span class="pl-k">val</span> <span class="pl-en">viewport</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> doc <span class="pl-k">&gt;&gt;</span> attr(<span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span>)(<span class="pl-s"><span class="pl-pds">"</span>meta[name=viewport]<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>If the element may or may not be in the page, the <code>&gt;?&gt;</code> tries to extract the content and returns it wrapped in an <code>Option</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Extract the element with id "optional" if it exists, return `None` if it</span>
<span class="pl-c">// doesn't:</span>
<span class="pl-k">val</span> <span class="pl-en">title</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Element</span>] <span class="pl-k">=</span> doc <span class="pl-k">&gt;</span><span class="pl-k">?</span><span class="pl-k">&gt;</span> element(<span class="pl-s"><span class="pl-pds">"</span>#optional<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>With only these two operators, some useful things can already be achieved:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Go to a news website and extract the hyperlink inside the h1 element if it</span>
<span class="pl-c">// exists. Follow that link and print both the article title and its short</span>
<span class="pl-c">// description (inside ".lead")</span>
<span class="pl-k">for</span> {
  headline <span class="pl-k">&lt;</span><span class="pl-k">-</span> browser.get(<span class="pl-s"><span class="pl-pds">"</span>http://observador.pt<span class="pl-pds">"</span></span>) <span class="pl-k">&gt;</span><span class="pl-k">?</span><span class="pl-k">&gt;</span> element(<span class="pl-s"><span class="pl-pds">"</span>h1 a<span class="pl-pds">"</span></span>)
  headlineDesc <span class="pl-k">=</span> browser.get(headline.attr(<span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>)) <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>.lead<span class="pl-pds">"</span></span>)
} println(<span class="pl-s"><span class="pl-pds">"</span>== <span class="pl-pds">"</span></span> <span class="pl-k">+</span> headline.text <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span> ==<span class="pl-cce">\n</span><span class="pl-pds">"</span></span> <span class="pl-k">+</span> headlineDesc)</pre>
  </div> 
  <p>In the next two sections the core classes used by this library are presented. They are followed by a description of the full capabilities of the DSL, including the ability to parse content after extracting, validating the contents of a page and defining custom extractors or validators.</p> 
  <h2><a id="user-content-core-model" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#core-model" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Core Model</h2> 
  <p>The library represents HTML documents and their elements by <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/main/scala/net/ruippeixotog/scalascraper/model/Document.scala" target="_blank">Document</a> and <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/main/scala/net/ruippeixotog/scalascraper/model/Element.scala" target="_blank">Element</a> objects, simple interfaces containing several methods for retrieving information and navigating throughout the DOM.</p> 
  <p><a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/main/scala/net/ruippeixotog/scalascraper/browser/Browser.scala" target="_blank">Browser</a> implementations are the entrypoints for obtaining <code>Document</code> instances. They implement most notably <code>get</code>, <code>post</code>, <code>parseFile</code> and <code>parseString</code> methods for retrieving documents from different sources. Depending on the browser used, <code>Document</code> and <code>Element</code> instances may have different semantics, mainly on their immutability guarantees.</p> 
  <h2><a id="user-content-browsers" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#browsers" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Browsers</h2> 
  <p>The library currently provides two built-in implementations of <code>Browser</code>:</p> 
  <ul> 
   <li><a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/main/scala/net/ruippeixotog/scalascraper/browser/JsoupBrowser.scala" target="_blank">JsoupBrowser</a> is backed by <a href="http://jsoup.org/" target="_blank">jsoup</a>, a Java HTML parser library. <code>JsoupBrowser</code> provides powerful and efficient document querying, but it doesn't run JavaScript in the pages. As such, it is limited to working strictly with the HTML send in the page source;</li> 
   <li><a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/main/scala/net/ruippeixotog/scalascraper/browser/HtmlUnitBrowser.scala" target="_blank">HtmlUnitBrowser</a> is based on <a href="http://htmlunit.sourceforge.net" target="_blank">HtmlUnit</a>, a GUI-less browser for Java programs. <code>HtmlUnitBrowser</code> simulates thoroughly a web browser, executing JavaScript code in the pages besides parsing and modelling its HTML content. It supports several compatibility modes, allowing it to emulate browsers such as Internet Explorer.</li> 
  </ul> 
  <p>Due to its speed and maturity, <code>JsoupBrowser</code> is the recommended browser to use when JavaScript execution is not needed. More information about each browser and its semantics can be obtained in each implementations' Scaladoc.</p> 
  <h2><a id="user-content-content-extraction" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#content-extraction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Content Extraction</h2> 
  <p>The <code>&gt;&gt;</code> and <code>&gt;?&gt;</code> operators shown above accept an <code>HtmlExtractor</code> as their right argument, which has a very simple interface:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">HtmlExtractor</span>[<span class="pl-k">+</span><span class="pl-en">A</span>] {
  <span class="pl-k">def</span> <span class="pl-en">extract</span>(<span class="pl-v">doc</span>: <span class="pl-en">Elements</span>)<span class="pl-k">:</span> <span class="pl-en">A</span>
}</pre>
  </div> 
  <p>One can always create a custom extractor by implementing <code>HtmlExtractor</code>. However, the DSL provides several useful constructors for <code>HtmlExtractor</code> instances. In general, you can use the <code>extractor</code> factory method:</p> 
  <div class="highlight highlight-source-scala">
   <pre>doc <span class="pl-k">&gt;&gt;</span> extractor(&lt;<span class="pl-ent">cssQuery</span>&gt;, &lt;<span class="pl-ent">contentExtractor</span>&gt;, &lt;<span class="pl-ent">contentParser</span>&gt;)</pre>
  </div> 
  <p>Where the arguments are:</p> 
  <ul> 
   <li><strong>cssQuery</strong>: the CSS query used to select the elements to be processed;</li> 
   <li><strong>contentExtractor</strong>: defines the content to be extracted from the selected elements, e.g. the element objects themselves, their text, a specific attribute, form data;</li> 
   <li><strong>contentParser</strong>: an optional parser for the data extracted in the step above, such as parsing numbers and dates or using regexes.</li> 
  </ul> 
  <p>The DSL provides several <code>contentExtractor</code> and <code>contentParser</code> instances, which were imported before with <code>DSL.Extract._</code> and <code>DSL.Parse._</code>. The full list can be seen in the <code>ContentExtractors</code> and <code>ContentParsers</code> objects inside <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/main/scala/net/ruippeixotog/scalascraper/scraper/HtmlExtractor.scala" target="_blank">HtmlExtractor.scala</a>.</p> 
  <p>Some usage examples:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Extract the date from the "#date-taken" element</span>
doc <span class="pl-k">&gt;&gt;</span> extractor(<span class="pl-s"><span class="pl-pds">"</span>#date-taken<span class="pl-pds">"</span></span>, text, asDate(<span class="pl-s"><span class="pl-pds">"</span>yyyy-MM-dd<span class="pl-pds">"</span></span>))

<span class="pl-c">// Extract the text of all ".price" elements and parse each of them as a number</span>
doc <span class="pl-k">&gt;&gt;</span> extractor(<span class="pl-s"><span class="pl-pds">"</span>section .price<span class="pl-pds">"</span></span>, texts, seq(asDouble))

<span class="pl-c">// Extract an element "#card" and do no parsing (the default parsing behavior)</span>
doc <span class="pl-k">&gt;&gt;</span> extractor(<span class="pl-s"><span class="pl-pds">"</span>#card<span class="pl-pds">"</span></span>, element, asIs[<span class="pl-en">Element</span>])</pre>
  </div> 
  <p>The DSL also provides implicit conversions to write more succinctly the most common extractor types:</p> 
  <ul> 
   <li>Writing <code>&lt;contentExtractor&gt;(&lt;cssQuery&gt;)</code> is taken as <code>extractor(&lt;cssQuery&gt;, &lt;contentExtractor&gt;, asIs)</code>;</li> 
   <li>Writing <code>&lt;cssQuery&gt;</code> is taken as <code>extractor(&lt;cssQuery&gt;, texts, asIs)</code>.</li> 
  </ul> 
  <p>That way, one can write the expressions in the Quick Start section, as well as:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Extract the elements with class "article"</span>
doc <span class="pl-k">&gt;&gt;</span> elements(<span class="pl-s"><span class="pl-pds">"</span>.article<span class="pl-pds">"</span></span>)

<span class="pl-c">// Extract the text inside each p element</span>
doc <span class="pl-k">&gt;&gt;</span> texts(<span class="pl-s"><span class="pl-pds">"</span>p<span class="pl-pds">"</span></span>)

<span class="pl-c">// Exactly the same as the extractor above</span>
doc <span class="pl-k">&gt;&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>p<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-content-validation" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#content-validation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Content Validation</h2> 
  <p>While scraping web pages, it is a common use case to validate if a page effectively has the expected structure. This library provides special support for creating and applying validations.</p> 
  <p>A <code>HtmlValidator</code> has the following signature:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">HtmlValidator</span>[<span class="pl-k">+</span><span class="pl-en">R</span>] {
  <span class="pl-k">def</span> <span class="pl-en">matches</span>(<span class="pl-v">doc</span>: <span class="pl-en">Elements</span>)<span class="pl-k">:</span> <span class="pl-k">Boolean</span>
  <span class="pl-k">def</span> <span class="pl-en">result</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">R</span>]
}</pre>
  </div> 
  <p>As with extractors, the DSL provides the <code>validator</code> constructor and the <code>~/~</code> operator for applying a validation to a document:</p> 
  <div class="highlight highlight-source-scala">
   <pre>doc <span class="pl-k">~/~</span> validator(&lt;<span class="pl-ent">extractor</span>&gt;)(&lt;<span class="pl-ent">matcher</span>&gt;)</pre>
  </div> 
  <p>Where the arguments are:</p> 
  <ul> 
   <li><strong>extractor</strong>: an extractor as defined in the previous section;</li> 
   <li><strong>matcher</strong>: a function mapping the extracted content to a boolean indicating if the document is valid.</li> 
  </ul> 
  <p>The result of a validation is a <code>Validated[A, R]</code> instance, where <code>A</code> is the type of the document and <code>R</code> is the result type of the validation (which will be explained later). A <code>Validated</code> can be either a <code>VSuccess(a: A)</code> or a <code>VFailure(res: R)</code>.</p> 
  <p>Some validation examples:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.ruippeixotog.scalascraper.util.Validated.</span><span class="pl-v">_</span>

<span class="pl-c">// Check if the title of the page is "My Page"</span>
doc <span class="pl-k">~/~</span> validator(text(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>))(_ <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>My Page<span class="pl-pds">"</span></span>) <span class="pl-k">match</span> {
  <span class="pl-k">case</span> <span class="pl-en">VSuccess</span>(_) <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>Correct!<span class="pl-pds">"</span></span>)
  <span class="pl-k">case</span> <span class="pl-en">VFailure</span>(_) <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>Wrong title<span class="pl-pds">"</span></span>)
}

<span class="pl-c">// Check if there are at least 3 items</span>
doc <span class="pl-k">~/~</span> validator(<span class="pl-s"><span class="pl-pds">"</span>.item<span class="pl-pds">"</span></span>)(_.size <span class="pl-k">&gt;=</span> <span class="pl-c1">3</span>)

<span class="pl-c">// Check if the text in ".desc" contains the word "blue"</span>
doc <span class="pl-k">~/~</span> validator(text(<span class="pl-s"><span class="pl-pds">"</span>.desc<span class="pl-pds">"</span></span>))(_.contains(<span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>))</pre>
  </div> 
  <p>When a document fails a validation, it may be useful to identify the problem by pattern-matching it against common scraping pitfalls, such as a login page that appears unexpectedly because of an expired cookie, dynamic content that disappeared or server-side errors. Validators can be also used to match "error" pages instead of expected pages:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">succ</span> <span class="pl-k">=</span> validator(text(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>))(_ <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>My Page<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">errors</span> <span class="pl-k">=</span> <span class="pl-en">Seq</span>(
  validator(text(<span class="pl-s"><span class="pl-pds">"</span>.msg<span class="pl-pds">"</span></span>))(_.contains(<span class="pl-s"><span class="pl-pds">"</span>sign in<span class="pl-pds">"</span></span>)) withResult <span class="pl-s"><span class="pl-pds">"</span>Not logged in<span class="pl-pds">"</span></span>,
  validator(<span class="pl-s"><span class="pl-pds">"</span>.item<span class="pl-pds">"</span></span>)(_.size <span class="pl-k">&lt;</span> <span class="pl-c1">3</span>) withResult <span class="pl-s"><span class="pl-pds">"</span>Too few items<span class="pl-pds">"</span></span>,
  validator(text(<span class="pl-s"><span class="pl-pds">"</span>h1<span class="pl-pds">"</span></span>))(_.contains(<span class="pl-s"><span class="pl-pds">"</span>500<span class="pl-pds">"</span></span>)) withResult <span class="pl-s"><span class="pl-pds">"</span>Internal Server Error<span class="pl-pds">"</span></span>)

doc <span class="pl-k">~/~</span> (succ, errors) <span class="pl-k">match</span> {
  <span class="pl-k">case</span> <span class="pl-en">VSuccess</span>(_) <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>yey<span class="pl-pds">"</span></span>)
  <span class="pl-k">case</span> <span class="pl-en">VFailure</span>(msg) <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>Error: $msg<span class="pl-pds">"</span></span>)
}</pre>
  </div> 
  <p>For validators matching errors, <code>withResult</code> should be used most times. It returns a new validator holding a <code>result</code> value which will be returned wrapped in a <code>VFailure</code> if that particular error ever occurs.</p> 
  <h2><a id="user-content-other-dsl-features" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#other-dsl-features" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Other DSL Features</h2> 
  <p>As shown before in the Quick Start section, one can try if an extractor works in a page and obtain the extracted content wrapped in an <code>Option</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Try to extract an element with id "title", return `None` if none exist</span>
doc <span class="pl-k">&gt;</span><span class="pl-k">?</span><span class="pl-k">&gt;</span> element(<span class="pl-s"><span class="pl-pds">"</span>#title<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Note that when using <code>&gt;?&gt;</code> with content extractors that return sequences, such as <code>texts</code> and <code>elements</code>, <code>None</code> will never be returned (<code>Some(Seq())</code> will be returned instead).</p> 
  <p>If you want to use multiple extractors in a single document or element, you can pass tuples or triples to <code>&gt;&gt;</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Extract the text of the title element and all the form elements</span>
doc <span class="pl-k">&gt;&gt;</span> (text(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>), elements(<span class="pl-s"><span class="pl-pds">"</span>form<span class="pl-pds">"</span></span>))</pre>
  </div> 
  <p>The extraction operators work on <code>List</code>, <code>Option</code>, <code>Either</code>, <code>Validated</code> and other instances for which a <a href="https://github.com/scalaz/scalaz" target="_blank">Scalaz</a> <code>Functor</code> instance is provided. The extraction occurs by mapping over the functors:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Extract the titles of all documents in the list</span>
<span class="pl-en">List</span>(doc1, doc2) <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>)

<span class="pl-c">// Extract the title if the document is a `Some`</span>
<span class="pl-en">Option</span>(doc) <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>You can apply other extractors and validators to the result of an extraction, which is particularly powerful combined with the last feature shown above:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// From the "#menu" element, extract the text in the ".curr" element inside</span>
doc <span class="pl-k">&gt;&gt;</span> element(<span class="pl-s"><span class="pl-pds">"</span>#menu<span class="pl-pds">"</span></span>) <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>.curr<span class="pl-pds">"</span></span>)

<span class="pl-c">// Same as above, but in a scenario where "#menu" can be absent</span>
doc <span class="pl-k">&gt;</span><span class="pl-k">?</span><span class="pl-k">&gt;</span> element(<span class="pl-s"><span class="pl-pds">"</span>#menu<span class="pl-pds">"</span></span>) <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>.curr<span class="pl-pds">"</span></span>)

<span class="pl-c">// Same as above, but check if the "#menu" has any section before extracting</span>
<span class="pl-c">// the text</span>
doc <span class="pl-k">&gt;</span><span class="pl-k">?</span><span class="pl-k">&gt;</span> element(<span class="pl-s"><span class="pl-pds">"</span>#menu<span class="pl-pds">"</span></span>) <span class="pl-k">~/~</span> validator(<span class="pl-s"><span class="pl-pds">"</span>section<span class="pl-pds">"</span></span>)(_.nonEmpty) <span class="pl-k">&gt;&gt;</span> text(<span class="pl-s"><span class="pl-pds">"</span>.curr<span class="pl-pds">"</span></span>)

<span class="pl-c">// Extract the links inside all the ".article" elements</span>
doc <span class="pl-k">&gt;&gt;</span> elementList(<span class="pl-s"><span class="pl-pds">"</span>.article<span class="pl-pds">"</span></span>) <span class="pl-k">&gt;&gt;</span> attr(<span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>)(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>This library also provides a <code>Functor</code> for <code>HtmlExtractor</code>, which makes it possible to map over extractors and create chained extractors that can be passed around and stored like objects:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// An extractor for the links inside all the ".article" elements</span>
<span class="pl-k">val</span> <span class="pl-en">linksExtractor</span> <span class="pl-k">=</span> elementList(<span class="pl-s"><span class="pl-pds">"</span>.article<span class="pl-pds">"</span></span>) <span class="pl-k">&gt;&gt;</span> attr(<span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>)(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>)
doc <span class="pl-k">&gt;&gt;</span> linksExtractor

<span class="pl-c">// An extractor for the number of links</span>
<span class="pl-k">val</span> <span class="pl-en">linkCountExtractor</span> <span class="pl-k">=</span> linksExtractor.map(_.length)
doc <span class="pl-k">&gt;&gt;</span> linkCountExtractor</pre>
  </div> 
  <p>Just remember that you can only apply extraction operators <code>&gt;&gt;</code> and <code>&gt;?&gt;</code> to documents, elements or functors "containing" them, which means that the following is a compile-time error:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// The `texts` extractor extracts a list of strings and extractors cannot be</span>
<span class="pl-c">// applied to strings</span>
doc <span class="pl-k">&gt;&gt;</span> texts(<span class="pl-s"><span class="pl-pds">"</span>.article<span class="pl-pds">"</span></span>) <span class="pl-k">&gt;&gt;</span> attr(<span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>)(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Finally, if you prefer not using operators for the sake of code legibility, you can use full method names:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// `extract` is the same as `&gt;&gt;`</span>
doc extract text(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>)

<span class="pl-c">// `tryExtract` is the same as `&gt;?&gt;`</span>
doc tryExtract element(<span class="pl-s"><span class="pl-pds">"</span>#optional<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <h2><a id="user-content-integration-with-typesafe-config" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#integration-with-typesafe-config" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Integration with Typesafe Config</h2> 
  <p>Matchers and validators can be loaded from a <a href="https://github.com/typesafehub/config" target="_blank">Typesafe config</a> using the methods <code>matcherAt</code>, <code>validatorAt</code> and <code>validatorsAt</code> of the DSL. Take a look at the <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/test/resources/examples.conf" target="_blank">examples.conf</a> config used <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/test/scala/net/ruippeixotog/scalascraper/Examples.scala" target="_blank">in the examples</a> and at the <a href="https://github.com/ruippeixotog/scala-scraper/blob/master/src/test/resources/examples.conf" target="_blank">application.conf</a> used in tests to see how they can be used.</p> 
  <p><em>NOTE: this feature is in a beta stage. Please expect API changes in future releases.</em></p> 
  <h2><a id="user-content-working-behind-an-httphttps-proxy" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#working-behind-an-httphttps-proxy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Working Behind an HTTP/HTTPS Proxy</h2> 
  <p>If you are behind an HTTP proxy, you can configure <code>Browser</code> implementations to make connections through it by setting the Java system properties <code>http.proxyHost</code>, <code>https.proxyHost</code>, <code>http.proxyPort</code> and <code>https.proxyPort</code>. Scala Scraper provides a <code>ProxyUtils</code> object that facilitates that configuration:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">ProxyUtils</span>.setProxy(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">3128</span>)
<span class="pl-k">val</span> <span class="pl-en">browser</span> <span class="pl-k">=</span> <span class="pl-en">JsoupBrowser</span>()
<span class="pl-c">// HTTP requests and scraping operations...</span>
<span class="pl-en">ProxyUtils</span>.removeProxy()</pre>
  </div> 
  <p><code>JsoupBrowser</code> uses internally <code>java.net.HttpURLConnection</code>. Configuring those JVM-wide system properties will affect not only <code>Browser</code> instances, but <em>all</em> requests done using <code>HttpURLConnection</code> directly or indirectly. <code>HtmlUnitBrowser</code> was implementated so that it reads the same system properties for configuration, but once the browser is created they will be used on every request done by the instance, regardless of the properties' values at the time of the request.</p> 
  <p><em>NOTE: this feature is in a beta stage. Please expect API changes in future releases.</em></p> 
  <h2><a id="user-content-copyright" class="anchor" href="https://github.com/ruippeixotog/scala-scraper#copyright" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Copyright</h2> 
  <p>Copyright (c) 2014-2016 Rui Gon√ßalves. See LICENSE for details.</p> 
 </article>
</div>