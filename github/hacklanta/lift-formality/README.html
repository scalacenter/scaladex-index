<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-formality" class="anchor" href="https://github.com/hacklanta/lift-formality#formality" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Formality</h1> 
  <p>Formality is a library that provides better, cleaner, more palatable form handling for Lift. Form handling without the pain, if you will.</p> 
  <p>The goal of creating this library was to eliminate as much repetition as possible while wielding the full power of Lift's stateful form mechanism and its CSS selector transforms, as well as embracing Lift's own error-reporting mechanisms.</p> 
  <h2><a id="user-content-status" class="anchor" href="https://github.com/hacklanta/lift-formality#status" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Status</h2> 
  <p>Formality is still in an early state. While there are tests ensuring everything works, use in production is likely to uncover some undiscovered bugs. Those bugs will be crushed as quickly as possible once reported on Github.</p> 
  <h2><a id="user-content-including" class="anchor" href="https://github.com/hacklanta/lift-formality#including" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Including</h2> 
  <p>You can include Formality directly as a dependency in your <code>build.sbt</code>:</p> 
  <pre><code>libraryDependencies ++= Seq(
  "com.hacklanta" %% "lift-formality" % "1.0.0"
)
</code></pre> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/hacklanta/lift-formality#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Formality provides a DSL for binding forms already defined in the HTML. It leaves as much of the markup as possible to the markup itself, and layers on only the necessary functionality from Lift's side. Amongst other things, this means that the <code>type</code> of a field in the HTML is left to the markup.</p> 
  <p>A basic form snippet would look like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">import</span> <span class="pl-v">com.hacklanta.formality.Formality.</span><span class="pl-v">_</span>

  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.name<span class="pl-pds">"</span></span>),
      field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.phone-number<span class="pl-pds">"</span></span>),
      field[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>.age<span class="pl-pds">"</span></span>),
      checkboxField(<span class="pl-s"><span class="pl-pds">"</span>#terms-and-conditions<span class="pl-pds">"</span></span>)
    ) onSuccess { (name, phoneNumber, age, termsAndConditions) <span class="pl-k">=&gt;</span>
      <span class="pl-c">// Assuming a case class User(name: String, age: Int, phoneNumber: String, termsAndConditions: Boolean).</span>
      <span class="pl-en">User</span>(name, age, phoneNumber, termsAndConditions).save
    }

  <span class="pl-s"><span class="pl-pds">"</span>form<span class="pl-pds">"</span></span> #<span class="pl-k">&gt;</span> registrationForm.binder</pre>
  </div> 
  <p>The corresponding HTML5 markup could be:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">form</span> <span class="pl-e">data-lift</span>=<span class="pl-s"><span class="pl-pds">"</span>Registration.form<span class="pl-pds">"</span></span>&gt;
  &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>&gt;
  &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>phone-number<span class="pl-pds">"</span></span> <span class="pl-e">placeholder</span>=<span class="pl-s"><span class="pl-pds">"</span>(XXX) XXX-XXXX<span class="pl-pds">"</span></span>&gt;
  &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>&gt;

  &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">"</span>terms-and-conditions&gt;</span>
<span class="pl-s">    &lt;input type=<span class="pl-pds">"</span></span><span class="pl-e">checkbox</span><span class="pl-s"><span class="pl-pds">"</span> id=<span class="pl-pds">"</span></span><span class="pl-e">terms-and-conditions</span><span class="pl-s"><span class="pl-pds">"</span>&gt;</span>
<span class="pl-s">    I agree to the &lt;a href=<span class="pl-pds">"</span></span>/<span class="pl-e">terms</span><span class="pl-s"><span class="pl-pds">"</span>&gt;Terms and Conditions&lt;/a&gt;</span>
<span class="pl-s">  &lt;/label&gt;</span>
<span class="pl-s">&lt;/form&gt;</span></pre>
  </div> 
  <p>This is a very basic registration form with no validations or event callbacks. The key here is that our success handler gets a set of properly-typed values. It is only called if all of the entries can properly be deserialized into their requested types (for example, putting in "hello" for the age would mean the success callback would not run).</p> 
  <p>Behind the scenes, Formality tries to deserialize the values. If the deserialization fails, <code>S.error</code> is automatically set for the appropriate field. You can then customize the behavior of <code>S.error</code> as you desire (see <a href="http://liftweb.net/api/26/api/net/liftweb/http/LiftRules.html" target="_blank">LiftRules</a> for more, specifically the <code>noticesToJsCmd</code> property).</p> 
  <h3><a id="user-content-validations" class="anchor" href="https://github.com/hacklanta/lift-formality#validations" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Validations</h3> 
  <p>Formality can also do validation:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">import</span> <span class="pl-v">com.hacklanta.formality.Formality.</span><span class="pl-v">_</span>
  <span class="pl-k">import</span> <span class="pl-v">com.hacklanta.formality.Html5Validations.</span><span class="pl-v">_</span>

  <span class="pl-k">val</span> <span class="pl-en">nameField</span> <span class="pl-k">=</span> field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.name<span class="pl-pds">"</span></span>) <span class="pl-k">?</span> notEmpty
  <span class="pl-k">val</span> <span class="pl-en">phoneNumberField</span> <span class="pl-k">=</span> field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.phone-number<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">ageField</span> <span class="pl-k">=</span> field[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>.age<span class="pl-pds">"</span></span>) <span class="pl-k">?</span> inRange(<span class="pl-c1">15</span>, <span class="pl-c1">120</span>)
  <span class="pl-k">val</span> <span class="pl-en">termsField</span> <span class="pl-k">=</span>
    checkboxField(<span class="pl-s"><span class="pl-pds">"</span>#terms-and-conditions<span class="pl-pds">"</span></span>) <span class="pl-k">?</span> { <span class="pl-v">incoming</span>: <span class="pl-k">Boolean</span> <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span> (incoming) {
        <span class="pl-en">Empty</span>
      } <span class="pl-k">else</span> {
        <span class="pl-en">Full</span>(<span class="pl-s"><span class="pl-pds">"</span>You must agree to the terms and conditions.<span class="pl-pds">"</span></span>)
      }
    }

  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      nameField,
      phoneNumberField,
      ageField,
      termsField
    ) onSuccess {
      <span class="pl-c">// same as above</span>
    }</pre>
  </div> 
  <p>Now we've taken it a step further. Validations can be simple functions. These functions take the deserialized value (i.e., the value after it has been typed properly) and return a <code>Full</code> <code>Box</code> with an error message when there is an error, or an <code>Empty</code> <code>Box</code> if the value is valid. In cases where a validation fails (by providing an error message), that error message is associated with the appropriate field by calling <code>S.error</code>.</p> 
  <p>Validations can also be more than simple functions. The built-in validations, like <code>inRange</code> and <code>notEmpty</code>, extend the <code>Validation</code> trait. These <code>Validation</code>s are still functions that work as specified above (i.e., they have an <code>apply</code> method that behaves as we specified above). However, they also have a <code>binder</code> method that returns a <code>CssSel</code>. These can be used to provide client-side attributes to also enforce the validation client-side. Client-side validations have the advantage of being able to run faster and without taxing the server. <code>Validation</code>s allow you to specify client-side validations and pair them with server-side validations to ensure that valid data is what makes it into your database.</p> 
  <p>The two built-ins used above are from the <code>Html5Validations</code> object, which does client-side validation using HTML5 attributes. In particular, the <code>notEmpty</code> validation applies a <code>required</code> attribute to the input, and the <code>inRange</code> validation applies <code>min</code> and <code>max</code> attributes to the input.</p> 
  <p>Also in progress is an object, <code>ParsleyValidations</code>, meant to support the set of validations that are supported by <a href="http://parsleyjs.org" target="_blank">Parsley.js</a>. These will have matching server-side validation implementations.</p> 
  <p>In certain very specific cases, it can be useful to run a validation even if the value in question isn't actually submitted in the form. Typically this is used for a check that a required field was submitted, particularly when it comes from a checkbox or radio button. Either way, in these cases a validation can take a <code>Box[T]</code> instead of <code>T</code>. It will receive an <code>Empty</code> if the field is not submitted, and a <code>Full</code> with the deserialized value if the field is submitted. Lift-formality's own <code>notBlank</code>/<code>notEmpty</code> validators will correctly handle unsubmitted fields.</p> 
  <h3><a id="user-content-event-handling" class="anchor" href="https://github.com/hacklanta/lift-formality#event-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Event handling</h3> 
  <p>Formality can also add server-side event handlers to form inputs:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">import</span> <span class="pl-v">com.hacklanta.formality.Formality.</span><span class="pl-v">_</span>
  <span class="pl-k">import</span> <span class="pl-v">com.hacklanta.formality.Html5Validations.</span><span class="pl-v">_</span>

  <span class="pl-k">val</span> <span class="pl-en">nameField</span> <span class="pl-k">=</span> field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.name<span class="pl-pds">"</span></span>) <span class="pl-k">?</span> notEmpty
  <span class="pl-k">val</span> <span class="pl-en">phoneNumberField</span> <span class="pl-k">=</span> field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.phone-number<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">ageField</span> <span class="pl-k">=</span>
    field[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>.age<span class="pl-pds">"</span></span>) <span class="pl-k">?</span>
      inRange(<span class="pl-c1">15</span>, <span class="pl-c1">120</span>) <span class="pl-k">-</span><span class="pl-k">&gt;</span>
      on(<span class="pl-s"><span class="pl-pds">"</span>change<span class="pl-pds">"</span></span>, { <span class="pl-v">incoming</span>: <span class="pl-k">Int</span> <span class="pl-k">=&gt;</span>
        <span class="pl-k">if</span> (incoming <span class="pl-k">&lt;</span> <span class="pl-c1">15</span>) {
          <span class="pl-en">Run</span>(<span class="pl-s"><span class="pl-pds">"</span>$('#terms-and-conditions').attr('disabled', 'disabled')<span class="pl-pds">"</span></span>)
        }
      })
  <span class="pl-k">val</span> <span class="pl-en">termsField</span> <span class="pl-k">=</span>
    checkboxField(<span class="pl-s"><span class="pl-pds">"</span>#terms-and-conditions<span class="pl-pds">"</span></span>) <span class="pl-k">?</span> { <span class="pl-v">incoming</span>: <span class="pl-k">Boolean</span> <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span> (incoming) {
        <span class="pl-en">Empty</span>
      } <span class="pl-k">else</span> {
        <span class="pl-en">Full</span>(<span class="pl-s"><span class="pl-pds">"</span>You must agree to the terms and conditions.<span class="pl-pds">"</span></span>)
      }
    }

  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      nameField,
      phoneNumberField,
      ageField,
      termsField
    ) onSuccess {
        <span class="pl-c">// same as above</span>
    }</pre>
  </div> 
  <p><code>-&gt; on(&lt;event&gt;, &lt;handler)</code> is the syntax used to add an event handler to a field. The <code>event</code> is whatever the event name will be on the client, as a <code>String</code>, and the <code>handler</code> takes in the deserialized incoming value and does something with it. It is expected to return a <code>JsCmd</code>, though keep in mind that there is an implicit conversion from <code>Unit</code> to <code>JsCmd</code> when necessary. Above, on change, we disable the terms and conditions checkbox to ensure the user cannot select it if they are below 15<a href="https://github.com/hacklanta/lift-formality#client-note" target="_blank">*</a><a name="user-content-client-note-return" target="_blank" href=""></a>.</p> 
  <p><a name="user-content-client-node" target="_blank" href=""></a>* - Obviously we could do this on the client as well, but this is merely an example :) <a href="https://github.com/hacklanta/lift-formality#client-note-return" target="_blank">â†©</a></p> 
  <h3><a id="user-content-operator-allergies" class="anchor" href="https://github.com/hacklanta/lift-formality#operator-allergies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Operator Allergies</h3> 
  <p>In case you have an aversion to using operators, the <code>?</code> operator that adds a validation to a field is originally named <code>validatingWith</code>, so you can use that instead. Additionally, the <code>-&gt;</code> operator that adds an event handler is originally named <code>handlingEvent</code>.</p> 
  <h3><a id="user-content-failure-handling" class="anchor" href="https://github.com/hacklanta/lift-formality#failure-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Failure Handling</h3> 
  <p>Formality's default behavior is to send down deserialization and validation errors using <code>S.error</code>. However, you may want to take additional action when dealing with failures. Or, you may want to ignore <code>S.error</code> in favor of your own error handling strategy. To do this, you can add a failure handler to the form:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      nameField,
      phoneNumberField,
      ageField,
      termsField
    ) onSuccess {
        <span class="pl-c">// same as above</span>
    } onFailure { failures <span class="pl-k">=&gt;</span>
      failures.foreach {
        <span class="pl-k">case</span> <span class="pl-en">ParamFailure</span>(message, _, _, validationErrors) <span class="pl-k">=&gt;</span>
          logger.error(<span class="pl-s"><span class="pl-pds">"</span>Got <span class="pl-pds">"</span></span> <span class="pl-k">+</span> message <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span> with validation errors: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> validationErrors)
        <span class="pl-k">case</span> <span class="pl-en">Failure</span>(message, _, _) <span class="pl-k">=&gt;</span>
          logger.error(<span class="pl-s"><span class="pl-pds">"</span>Got <span class="pl-pds">"</span></span> <span class="pl-k">+</span> message)
        <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span>
      }
    }</pre>
  </div> 
  <p>Note that the basic <code>Failure</code> message when validations fail simply says " failed validations." However, in such cases, the failure is a <code>ParamFailure</code> whose parameter is a list of <code>String</code>s representing the validation errors for that field.</p> 
  <h3><a id="user-content-field-groups" class="anchor" href="https://github.com/hacklanta/lift-formality#field-groups" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Field Groups</h3> 
  <p>Formality provides an abstraction above fields, called field groups. This lets you group fields into nested groups. By default, this looks like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      fieldGroup.withFields(
        nameField,
        phoneNumberField,
        ageField
      ),
      termsField
    ) onSuccess {
      <span class="pl-k">case</span> ((name <span class="pl-k">:</span><span class="pl-k">+</span><span class="pl-k">:</span> phoneNumber <span class="pl-k">:</span><span class="pl-k">+</span><span class="pl-k">:</span> age <span class="pl-k">:</span><span class="pl-k">+</span><span class="pl-k">:</span> <span class="pl-en">HNil</span>), terms) <span class="pl-k">=&gt;</span>
        <span class="pl-c">// Assuming a case class User(name: String, age: Int, phoneNumber: String) this time.</span>
        <span class="pl-k">if</span> (terms) {
          <span class="pl-en">User</span>(name, phoneNumber, age).save
        }
      <span class="pl-en">User</span>(name, age, phoneNumber, termsAndConditions).save
    }</pre>
  </div> 
  <p>But field groups also have a very important property: they can be converted into a different type using its <code>as</code> function. In particular, a field group can be a placeholder for a type that involves its combined fields. Let's redo the above:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      fieldGroup.withFields(
        nameField,
        phoneNumberField,
        ageField
      ).as(<span class="pl-en">User</span>.apply _),
      termsField
    ) onSuccess { (user, terms) <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span> (terms) {
        user.save
      }
    }</pre>
  </div> 
  <p>Our success handler now gets a full-on User object instead of the decomposed fields, and we could use the <code>User</code> constructor directly.</p> 
  <p><code>as</code> takes a function that takes the parameters from the group and produces a type T. However, sometimes we want to be able to fail at the conversion step. In those cases, we can use <code>withConverter</code> instead, which allows us to return a <code>Box[T]</code>, where a non-<code>Full</code> will cause a failed form submission:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      fieldGroup.withFields(
        nameField,
        phoneNumberField,
        ageField
      ).withConverter(<span class="pl-en">User</span>.createUnique _),
      termsField
    ) onSuccess { (user, terms) <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span> (terms) {
        user.save
      }
    }</pre>
  </div> 
  <p>Above, <code>createUnique</code> can be considered as a version of <code>User</code> that creates the new <code>User</code> object and returns a <code>Full</code> unless, say, the name is not unique. In that case it returns a <code>Failure</code>.</p> 
  <p>Note that failures at the group conversion level don't trigger <code>S.error</code>, since there's no concrete field to associate the failure with. You can do your own handling of the failure in the <code>onFailure</code> handler.</p> 
  <h4><a id="user-content-field-groups-with-boxed-converters" class="anchor" href="https://github.com/hacklanta/lift-formality#field-groups-with-boxed-converters" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Field groups with boxed converters</h4> 
  <p>Field groups can also use a converter that takes the boxed values of the fields that it is made up of. This can be used, for example, to make choices between two fields that supply the same data. Let's take as an example an upload form that accepts a document in PDF format or a pasted text file:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">fileNameField</span> <span class="pl-k">=</span> field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.file-name<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">pastedTextField</span> <span class="pl-k">=</span> field[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>.pasted-text<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">uploadedFileField</span> <span class="pl-k">=</span> fileUploadField(<span class="pl-s"><span class="pl-pds">"</span>.pasted-text<span class="pl-pds">"</span></span>)

  <span class="pl-k">val</span> <span class="pl-en">uploadForm</span> <span class="pl-k">=</span>
    form withFields(
      fileNameField,
      fieldGroup.withFields(
        pastedTextField,
        uploadedFileField
      ).withBoxedConverter { (<span class="pl-v">text</span>: <span class="pl-en">Box</span>[<span class="pl-k">String</span>], <span class="pl-v">file</span>: <span class="pl-en">Box</span>[<span class="pl-en">FileParamHolder</span>]) <span class="pl-k">=&gt;</span>
        text.map(_.getBytes(<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>)) or file.data
      }
    ).onSuccess { (<span class="pl-v">fileName</span>: <span class="pl-k">String</span>, <span class="pl-v">fileData</span>: <span class="pl-en">Array</span>[<span class="pl-en">Data</span>]))
      <span class="pl-en">DbFile</span>.create(fileName, fileData)
    }</pre>
  </div> 
  <p>Above, we have a form with a field for the file's name, and then a group that encloses the pasted text and the file upload. The converter receives both as boxed values, which will be <code>Empty</code> if the user didn't specify anything for the fields in question. The converter then uses the pasted text if it was specified, or if not chooses the file data. The success handler then only sees two parameters: the files name, and the final data array that represents its contents, which we've resolved in the field group converter.</p> 
  <h4><a id="user-content-scoping-field-groups" class="anchor" href="https://github.com/hacklanta/lift-formality#scoping-field-groups" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scoping field groups</h4> 
  <p>You can also add a scope to a field group. This is a CSS selector that ensures the fields in the field group are bound only if they're found within elements that match that selector:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">registrationForm</span> <span class="pl-k">=</span>
    form withFields(
      fieldGroup(<span class="pl-s"><span class="pl-pds">"</span>.user<span class="pl-pds">"</span></span>).withFields(
        nameField,
        phoneNumberField,
        ageField
      ).withConverter(<span class="pl-en">User</span>.createUnique _),
      termsField
    ) onSuccess ...</pre>
  </div> 
  <p>With the above code, the markup that we introduced at the beginning would no longer successfully bind the user part of the registration form. Instead, we would need something like this:</p> 
  <div class="highlight highlight-text-html-basic">
   <pre>&lt;<span class="pl-ent">form</span> <span class="pl-e">data-lift</span>=<span class="pl-s"><span class="pl-pds">"</span>Registration.form<span class="pl-pds">"</span></span>&gt;
  &lt;<span class="pl-ent">fieldset</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">legend</span>&gt;User Information&lt;/<span class="pl-ent">legend</span>&gt;

    &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>phone-number<span class="pl-pds">"</span></span> <span class="pl-e">placeholder</span>=<span class="pl-s"><span class="pl-pds">"</span>(XXX) XXX-XXXX<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">input</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>&gt;
  &lt;/<span class="pl-ent">fieldset</span>&gt;

  &lt;<span class="pl-ent">label</span> <span class="pl-e">for</span>=<span class="pl-s"><span class="pl-pds">"</span>terms-and-conditions&gt;</span>
<span class="pl-s">    &lt;input type=<span class="pl-pds">"</span></span><span class="pl-e">checkbox</span><span class="pl-s"><span class="pl-pds">"</span> id=<span class="pl-pds">"</span></span><span class="pl-e">terms-and-conditions</span><span class="pl-s"><span class="pl-pds">"</span>&gt;</span>
<span class="pl-s">    I agree to the &lt;a href=<span class="pl-pds">"</span></span>/<span class="pl-e">terms</span><span class="pl-s"><span class="pl-pds">"</span>&gt;Terms and Conditions&lt;/a&gt;</span>
<span class="pl-s">  &lt;/label&gt;</span>
<span class="pl-s">&lt;/form&gt;</span></pre>
  </div> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/hacklanta/lift-formality#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p><code>lift-formality</code> is provided under the terms of the MIT License. No warranties are made, express or implied. See the <code>LICENSE</code> file in this same directory.</p> 
  <h1><a id="user-content-authorcontributors" class="anchor" href="https://github.com/hacklanta/lift-formality#authorcontributors" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Author/Contributors</h1> 
  <p><code>lift-formality</code> is copyright <a href="http://hacklanta.com" target="_blank">Hacklanta</a>, and was originally conceived and written by <a href="http://github.com/Shadowfiend" target="_blank">Antonio Salazar Cardozo</a>.</p> 
  <p>You can find our writings on the <a href="http://hacklanta.com/blog" target="_blank">Hacklanta blog</a>.</p> 
 </article>
</div>