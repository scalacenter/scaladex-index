<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-typesafe-conductr-bundle-library" class="anchor" href="https://github.com/typesafehub/conductr-lib#typesafe-conductr-bundle-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Typesafe ConductR Bundle Library</h1> 
  <p><a href="https://travis-ci.org/typesafehub/conductr-lib" target="_blank"><img src="https://camo.githubusercontent.com/7ca460aadbf2429192aa76d975e53d56f6087994/68747470733a2f2f6170692e7472617669732d63692e6f72672f74797065736166656875622f636f6e64756374722d6c69622e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://api.travis-ci.org/typesafehub/conductr-lib.png?branch=master" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-introduction" class="anchor" href="https://github.com/typesafehub/conductr-lib#introduction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Introduction</h2> 
  <p>This project provides a number of libraries to facilitate <a href="http://typesafe.com/products/conductr" target="_blank">ConductR</a>'s status service and its service lookup service. Note that usage of the libraries in your code is entirely benign when used outside of the context of ConductR i.e. you will find that your applications and services will continue to function normally when used without ConductR. We have also designed the libraries to be a convenience to ConductR's REST and environment variable based APIs, and to have a very low impact on your code.</p> 
  <p>Add one of the following libraries to your project.</p> 
  <ul> 
   <li><code>"com.typesafe.conductr" % "java-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "scala-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "akka24-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "akka25-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "play25-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "play26-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "lagom13-java-conductr-bundle-lib" % "2.0.2"</code></li> 
   <li><code>"com.typesafe.conductr" %% "lagom13-scala-conductr-bundle-lib" % "2.0.2"</code></li> 
  </ul> 
  <p>Note that the examples here use the following import to conveniently build the JDK <code>URI</code> and <code>URL</code> types.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.bundlelib.scala.</span>{<span class="pl-v">URL</span>, <span class="pl-v">URI</span>}</pre>
  </div> 
  <h2><a id="user-content-table-of-contents" class="anchor" href="https://github.com/typesafehub/conductr-lib#table-of-contents" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Table of contents</h2> 
  <ul> 
   <li><a href="https://github.com/typesafehub/conductr-lib#conductr-bundle-lib" target="_blank">conductr-bundle-lib</a></li> 
   <li><a href="https://github.com/typesafehub/conductr-lib#scala-conductr-bundle-lib" target="_blank">scala-conductr-bundle-lib</a></li> 
   <li><a href="https://github.com/typesafehub/conductr-lib#akka2425-conductr-bundle-lib" target="_blank">akka[24|25]-conductr-bundle-lib</a></li> 
   <li><a href="https://github.com/typesafehub/conductr-lib#play2526-conductr-bundle-lib" target="_blank">play[25|26]-conductr-bundle-lib</a></li> 
   <li><a href="https://github.com/typesafehub/conductr-lib#lagom13-java-conductr-bundle-lib" target="_blank">lagom13-java-conductr-bundle-lib</a></li> 
   <li><a href="https://github.com/typesafehub/conductr-lib#lagom13-scala-conductr-bundle-lib" target="_blank">lagom13-scala-conductr-bundle-lib</a></li> 
  </ul> 
  <h2><a id="user-content-conductr-bundle-lib" class="anchor" href="https://github.com/typesafehub/conductr-lib#conductr-bundle-lib" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>conductr-bundle-lib</h2> 
  <p>This library provides a base level of functionality mainly formed around constructing the requisite payloads for ConductR's RESTful services. The library is pure Java and has no dependencies other than the JDK.</p> 
  <p>Two services are covered by this library:</p> 
  <ul> 
   <li><code>com.typesafe.conductr.bundlelib.LocationService</code></li> 
   <li><code>com.typesafe.conductr.bundlelib.StatusService</code></li> 
  </ul> 
  <h3><a id="user-content-location-service" class="anchor" href="https://github.com/typesafehub/conductr-lib#location-service" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Location Service</h3> 
  <p>ConductR's location service is able to respond with a URI declaring where a given service (as named by a bundle component's endpoint) resides. The http payload can be constructed as follows:</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-smi">HttpPayload</span> payload <span class="pl-k">=</span> <span class="pl-smi">LocationService</span><span class="pl-k">.</span>createLookupPayload(<span class="pl-s"><span class="pl-pds">"</span>someservice<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>The <code>HttpPayload</code> object may then be queried for elements that will help you make an http request. These methods are:</p> 
  <ul> 
   <li><code>getUrl</code></li> 
   <li><code>getRequestMethod</code></li> 
   <li><code>getFollowRedirects</code></li> 
  </ul> 
  <p>When processing the http response you should check for the following http status codes:</p> 
  <ul> 
   <li>307 - temporary redirect - the service can be found at the location indicated by the <code>Location</code> header. <code>Cache-Control</code> may also be supplied to indicate how long the location may be cached for.</li> 
   <li>404 - not found - the service cannot be located at this time</li> 
  </ul> 
  <p>You should also prepare for timing out on a request and process as per a 404.</p> 
  <h3><a id="user-content-status-service" class="anchor" href="https://github.com/typesafehub/conductr-lib#status-service" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Status Service</h3> 
  <p>Conduct's status service is required by a bundle component in order to signal when it has started. A successful startup is anything that the application is required to do to become available for processing. For example, this may involved validating configuration. The http payload can be constructed as follows:</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-smi">HttpPayload</span> payload <span class="pl-k">=</span> <span class="pl-smi">StatusService</span><span class="pl-k">.</span>createSignalStartedPayload()</pre>
  </div> 
  <p>The <code>HttpPayload</code> object may then be queried for elements in the same way as for the location service of the previous section.</p> 
  <p>When processing the http response you should check for the following http status codes:</p> 
  <ul> 
   <li>2xx - success - any 200 series response is a success meaning that ConductR has successfully acknowledged the startup signal</li> 
   <li>xxx - failure - anything else constitutes an error and you should cause the bundle component to exit</li> 
  </ul> 
  <p>You should also prepare for timing out on a request and exit the bundle component if this occurs.</p> 
  <h2><a id="user-content-scala-conductr-bundle-lib" class="anchor" href="https://github.com/typesafehub/conductr-lib#scala-conductr-bundle-lib" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>scala-conductr-bundle-lib</h2> 
  <p>This library provides a reactive API using only Scala and Java types. There are no dependencies other than <code>conductr-bundle-lib</code>, Scala and the JDK and it is designed to be used where there is no Akka or Play dependency in your application.</p> 
  <p>As with <code>conductr-bundle-lib</code> there are two services:</p> 
  <ul> 
   <li><code>com.typesafe.conductr.bundlelib.scala.LocationService</code></li> 
   <li><code>com.typesafe.conductr.bundlelib.scala.StatusService</code></li> 
  </ul> 
  <p>Please read the section on <code>conductr-bundle-lib</code> for an introduction to these services.</p> 
  <h3><a id="user-content-locationservice" class="anchor" href="https://github.com/typesafehub/conductr-lib#locationservice" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>LocationService</h3> 
  <p>The LocationService looks up service names and processes HTTP's <code>307</code> "temporary redirect" responses to return the location of the resolved service (or a <code>404</code> if one cannot be found). Many HTTP clients allow the following of redirects, particularly when either of the <code>HEAD</code> or <code>GET</code> methods are used (other methods may be considered insecure by default). Therefore if the service you are locating is an HTTP one then using a regular HTTP client should require no further work. Here is an example of using the <a href="http://dispatch.databinder.net/Dispatch.html" target="_blank">Dispatch</a> library:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">svc</span> <span class="pl-k">=</span> <span class="pl-en">LocationService</span>.getLookupUrl(<span class="pl-s"><span class="pl-pds">"</span>someservice<span class="pl-pds">"</span></span>, <span class="pl-en">URL</span>(<span class="pl-s"><span class="pl-pds">"</span>http://127.0.0.1:9000/someservice<span class="pl-pds">"</span></span>))
<span class="pl-k">val</span> <span class="pl-en">svcResp</span> <span class="pl-k">=</span> <span class="pl-en">Http</span>.configure(_.setFollowRedirects(<span class="pl-c1">true</span>))(url(svc.toString).<span class="pl-en">OK</span>)</pre>
  </div> 
  <p>The above declares an <code>svc</code> val which will either be the one that ConductR provides, or one to use for development running on your machine.</p> 
  <p>When using HTTP clients, consider having the client cache responses. ConductR will return Cache-Control header information informing the client how to cache.</p> 
  <h4><a id="user-content-non-http-service-lookups" class="anchor" href="https://github.com/typesafehub/conductr-lib#non-http-service-lookups" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Non HTTP service lookups</h4> 
  <p>If the service you require is not HTTP based then you may use the <code>LocationService.lookup</code> function. The following code illustrates how a service may be located in place of creating and dispatching your own payload. The sample also shows how to use a cache provided specifically for these lookups (note use com.typesafe.lib.scala for 1.2 of this library onwards):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> This will require an implicit ConnectionContext to</span>
<span class="pl-c"><span class="pl-c">//</span> hold a Scala ExecutionContext. There are different</span>
<span class="pl-c"><span class="pl-c">//</span> ConnectionContexts depending on which flavor of the</span>
<span class="pl-c"><span class="pl-c">//</span> library is being used. For the Scala flavor, a Scala</span>
<span class="pl-c"><span class="pl-c">//</span> ExecutionContext is composed. The ExecutionContext</span>
<span class="pl-c"><span class="pl-c">//</span> is needed as "service" is returned as a Future.</span>
<span class="pl-c"><span class="pl-c">//</span> For convenience, we provide a global ConnectionContext</span>
<span class="pl-c"><span class="pl-c">//</span> that may be imported.</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.bundlelib.scala.ConnectionContext.Implicits.</span><span class="pl-v">global</span>

<span class="pl-k">val</span> <span class="pl-en">locationCache</span> <span class="pl-k">=</span> <span class="pl-en">LocationCache</span>()

<span class="pl-k">val</span> <span class="pl-en">service</span> <span class="pl-k">=</span> <span class="pl-en">LocationService</span>.lookup(<span class="pl-s"><span class="pl-pds">"</span>someservice<span class="pl-pds">"</span></span>, <span class="pl-en">URI</span>(<span class="pl-s"><span class="pl-pds">"</span>tcp://localhost:1234<span class="pl-pds">"</span></span>), locationCache)</pre>
  </div> 
  <p><code>service</code> is typed <code>Future[Option[URI]]</code> meaning that an optional URI response will be returned at some time in the future. Supposing that this lookup is made during the initialisation of your program, the service you're looking for may not exist. However calling the same function later on may yield the service. This is because services can come and go. Note that the fallback URI of <code>"tcp://localhost:1234"</code> will be returned if this function is called upon when started outside of ConductR.</p> 
  <p>The service response constitutes a URI that describes its location.</p> 
  <h4><a id="user-content-static-service-lookup" class="anchor" href="https://github.com/typesafehub/conductr-lib#static-service-lookup" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Static service lookup</h4> 
  <p>Some bundle components cannot proceed with their initialisation unless the service can be located. We encourage you to re-factor these components so that they look up services at the time when they are required, given that services can come and go. However if you are somehow stuck with this style of code then you may consider the following blocking code as a temporary measure:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">resultUri</span> <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(
  <span class="pl-en">LocationService</span>.lookup(<span class="pl-s"><span class="pl-pds">"</span>someservice<span class="pl-pds">"</span></span>, <span class="pl-en">URI</span>(<span class="pl-s"><span class="pl-pds">"</span>http://127.0.0.1:9000<span class="pl-pds">"</span></span>), locationCache),
  sometimeout)
<span class="pl-k">val</span> <span class="pl-en">serviceUri</span> <span class="pl-k">=</span> resultUri.getOrElse(<span class="pl-en">System</span>.exit(<span class="pl-c1">70</span>))</pre>
  </div> 
  <p>In the above, the program will exit if a service cannot be located at the time the program initializes; unless the program has not been started by ConductR in which case an alternate URI is provided.</p> 
  <h3><a id="user-content-statusservice" class="anchor" href="https://github.com/typesafehub/conductr-lib#statusservice" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>StatusService</h3> 
  <p>The following code illustrates how your bundle component should register its initial health with ConductR. Calling this function is to be done in place of creating and dispatching your own payload:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">StatusService</span>.signalStartedOrExit()</pre>
  </div> 
  <p>In general, the return value of <code>signalStartedOrExit</code> is not used and your program proceeds. If ConductR fails to reply, or replies with an error status then this bundle component will exit.</p> 
  <p>In case you are interested, the function returns a <code>Future[Option[Unit]]</code> where a future <code>Some(())</code> indicates that ConductR has successfully acknowledged the startup signal. A future of <code>None</code> indicates that the bundle has not been started by ConductR.</p> 
  <h2><a id="user-content-akka2425-conductr-bundle-lib" class="anchor" href="https://github.com/typesafehub/conductr-lib#akka2425-conductr-bundle-lib" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>akka[24|25]-conductr-bundle-lib</h2> 
  <p>This library provides a reactive API using <a href="http://akka.io/docs/" target="_blank">Akka Http</a> and should be used when you are using Akka. The library depends on <code>scala-conductr-bundle-lib</code> and can be used for both Java and Scala.</p> 
  <p>As with <code>conductr-bundle-lib</code> there are these two services:</p> 
  <ul> 
   <li><code>com.typesafe.conductr.bundlelib.akka.LocationService</code></li> 
   <li><code>com.typesafe.conductr.bundlelib.akka.StatusService</code></li> 
  </ul> 
  <p>and there is also another:</p> 
  <ul> 
   <li><code>com.typesafe.conductr.bundlelib.akka.Env</code></li> 
  </ul> 
  <p>Please read the section on <code>conductr-bundle-lib</code> and then <code>scala-conductr-bundle-lib</code> for an introduction to these services. The <code>Env</code> one is discussed in the "Akka Clustering" section below.</p> 
  <p>Other than the <code>import</code>s for the types, the only difference in terms of API are usage is how a <code>ConnectionContext</code> is established. A <code>ConnectionContext</code> for Akka requires an implicit <code>ActorSystem</code> or <code>ActorContext</code> at a minimum e.g.:</p> 
  <div class="highlight highlight-source-scala">
   <pre> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">cc</span> <span class="pl-k">=</span> <span class="pl-en">ConnectionContext</span>()</pre>
  </div> 
  <p>There is also a lower level method where the <code>HttpExt</code> and <code>ActorMaterializer</code> are passed in:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">cc</span> <span class="pl-k">=</span> <span class="pl-en">ConnectionContext</span>(httpExt, actorMaterializer)</pre>
  </div> 
  <p>When in the context of an actor, a convenient <code>ImplicitConnectionContext</code> trait may be mixed in to establish the <code>ConnectionContext</code>. The next section illustrates this in its sample <code>MyService</code> actor.</p> 
  <h3><a id="user-content-static-service-lookup-1" class="anchor" href="https://github.com/typesafehub/conductr-lib#static-service-lookup-1" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Static Service Lookup</h3> 
  <p>As a reminder, some bundle components cannot proceed with their initialisation unless the service can be located. We encourage you to re-factor these components so that they look up services at the time when they are required, given that services can come and go. That said, here is a non-blocking improvement on the example provided for the <code>scala-conductr-bundle-lib</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MyService</span>(<span class="pl-v">cache</span>: <span class="pl-en">CacheLike</span>) <span class="pl-k">extends</span> <span class="pl-e">Actor</span> <span class="pl-k">with</span> <span class="pl-e">ImplicitConnectionContext</span> {

  <span class="pl-k">import</span> <span class="pl-v">context.</span><span class="pl-v">dispatcher</span>

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">preStart</span>()<span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span>
    <span class="pl-en">LocationService</span>.lookup(<span class="pl-s"><span class="pl-pds">"</span>someservice<span class="pl-pds">"</span></span>, <span class="pl-en">URI</span>(<span class="pl-s"><span class="pl-pds">"</span>http://127.0.0.1:9000<span class="pl-pds">"</span></span>), cache).pipeTo(<span class="pl-c1">self</span>)

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">receive</span><span class="pl-k">:</span> <span class="pl-en">Receive</span> <span class="pl-k">=</span>
    initial

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">initial</span><span class="pl-k">:</span> <span class="pl-en">Receive</span> <span class="pl-k">=</span> {
    <span class="pl-k">case</span> <span class="pl-en">Some</span>(<span class="pl-v">someService</span>: <span class="pl-en">URI</span>) <span class="pl-k">=&gt;</span>
      <span class="pl-c"><span class="pl-c">//</span> We now have the service</span>

      context.become(service(someService))

    <span class="pl-k">case</span> <span class="pl-c1">None</span> <span class="pl-k">=&gt;</span>
      <span class="pl-c1">self</span> <span class="pl-k">!</span> <span class="pl-en">PoisonPill</span>
  }

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">service</span>(<span class="pl-v">someService</span>: <span class="pl-en">URI</span>)<span class="pl-k">:</span> <span class="pl-en">Receive</span> <span class="pl-k">=</span> {
    <span class="pl-c"><span class="pl-c">//</span> Regular actor receive handling goes here given that we have a service URI now.</span>
    ...
  }
}</pre>
  </div> 
  <p>This type of actor is used to handle service processing and should only receive service oriented messages once its dependent service URI is known. This is an improvement on the blocking example provided before, as it will not block. However it still has the requirement that <code>someservice</code> must be running at the point of initialization, and that it continues to run. Neither of these requirements may always be satisfied with a distributed system.</p> 
  <h3><a id="user-content-java" class="anchor" href="https://github.com/typesafehub/conductr-lib#java" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Java</h3> 
  <p>The following example illustrates how status is signalled using the Akka Java API:</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-smi">ConnectionContext</span> cc <span class="pl-k">=</span> <span class="pl-smi">ConnectionContext</span><span class="pl-k">.</span>create(system);
<span class="pl-smi">StatusService</span><span class="pl-k">.</span>getInstance()<span class="pl-k">.</span>signalStartedOrExitWithContext(cc);</pre>
  </div> 
  <p>Similarly here is a service lookup:</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-smi">ConnectionContext</span> cc <span class="pl-k">=</span> <span class="pl-smi">ConnectionContext</span><span class="pl-k">.</span>create(system);
<span class="pl-smi">LocationService</span><span class="pl-k">.</span>getInstance()<span class="pl-k">.</span>lookupWithContext(<span class="pl-s"><span class="pl-pds">"</span>whatever<span class="pl-pds">"</span></span>, <span class="pl-c1">URI</span>(<span class="pl-s"><span class="pl-pds">"</span>tcp://localhost:1234<span class="pl-pds">"</span></span>), cache, cc)</pre>
  </div> 
  <h3><a id="user-content-akka-clustering" class="anchor" href="https://github.com/typesafehub/conductr-lib#akka-clustering" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Akka Clustering</h3> 
  <p><a href="http://doc.akka.io/docs/akka/snapshot/scala/cluster-usage.html" target="_blank">Akka cluster</a> based applications or services have a requirement where the first node in a cluster must form the cluster, and the subsequent nodes join with any of the ones that come before them (seed nodes). Where bundles share the same <code>system</code> property in their <code>bundle.conf</code>, and have an intersection of endpoint names, then ConductR will ensure that only one bundle is started at a time. Thus the first bundle can determine whether it is the first bundle, and subsequent bundles can determine the IP and port numbers of the bundles that have started before them.</p> 
  <p>In order for an application or service to take advantage of this guarantee provided by ConductR, the following call is required to obtain configuration that will be used when establishing your actor system:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.bundlelib.akka.</span><span class="pl-v">Env</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.lib.akka.</span><span class="pl-v">ConnectionContext</span>

...

<span class="pl-k">val</span> <span class="pl-en">systemName</span> <span class="pl-k">=</span> <span class="pl-en">Env</span>.mkSystemName(<span class="pl-s"><span class="pl-pds">"</span>MyApp1<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-en">Env</span>.asConfig(systemName)
<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> <span class="pl-en">ActorSystem</span>(systemName, config.withFallback(<span class="pl-en">ConfigFactory</span>.load()))</pre>
  </div> 
  <p>Clusters will then be formed correctly. The above call looks for an endpoint named <code>akka-remote</code> by default. Therefore if you must declare the Akka remoting port as seed. The following endpoint declaration within a <code>build.sbt</code> shows how:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">BundleKeys</span>.endpoints <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>akka-remote<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Endpoint</span>(<span class="pl-s"><span class="pl-pds">"</span>tcp<span class="pl-pds">"</span></span>))</pre>
  </div> 
  <p>In the above, no declaration of <code>services</code> is required as akka remoting is an internal, cluster-wide TCP service.</p> 
  <h2><a id="user-content-play2526-conductr-bundle-lib" class="anchor" href="https://github.com/typesafehub/conductr-lib#play2526-conductr-bundle-lib" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>play[25|26]-conductr-bundle-lib</h2> 
  <blockquote> 
   <p>If you are using Play 2.5 or 2.6 then this section is for you.</p> 
  </blockquote> 
  <p><a href="https://github.com/typesafehub/sbt-conductr" target="_blank">sbt-conductr</a> is automatically adding this library to your Play project.</p> 
  <p>This library provides a reactive API using <a href="https://www.playframework.com/documentation/2.5.x/ScalaWS" target="_blank">Play WS</a> and should be used when you are using Play. The library depends on <code>akka24-conductr-bundle-lib</code> and can be used for both Java and Scala. As per Play's conventions, <code>play.api</code> is used for the Scala API and just <code>play</code> is used for Java.</p> 
  <p>As with <code>conductr-bundle-lib</code> there are two services:</p> 
  <ul> 
   <li><code>com.typesafe.conductr.bundlelib.play.LocationService</code> (Java) or <code>com.typesafe.conductr.bundlelib.play.api.LocationService</code> (Scala)</li> 
   <li><code>com.typesafe.conductr.bundlelib.play.StatusService</code> (Java) or <code>com.typesafe.conductr.bundlelib.play.api.StatusService</code> (Scala)</li> 
  </ul> 
  <p>and there is also another:</p> 
  <ul> 
   <li><code>com.typesafe.conductr.bundlelib.play.Env</code> (Java) or <code>com.typesafe.conductr.bundlelib.play.api.Env</code> (Scala)</li> 
  </ul> 
  <p>Please read the section on <code>conductr-bundle-lib</code> and then <code>scala-conductr-bundle-lib</code> for an introduction to these services. The <code>Env</code> one is discussed in the section below. The major difference between the APIs for Play 2.5 and the other variants is that components are expected to be injected. For example, to use the <code>LocationService</code> in your controller (Scala):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MyGreatController</span> <span class="pl-k">@</span><span class="pl-en">Inject</span>() (<span class="pl-v">locationService</span>: <span class="pl-en">LocationService</span>, <span class="pl-v">locationCache</span>: <span class="pl-en">CacheLike</span>) <span class="pl-k">extends</span> <span class="pl-e">Controller</span> {
  ...
  locationService.lookup(<span class="pl-s"><span class="pl-pds">"</span>known<span class="pl-pds">"</span></span>, <span class="pl-en">URI</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>), locationCache)
  ...
}</pre>
  </div> 
  <p>The following components are available for injection:</p> 
  <ul> 
   <li>CacheLike</li> 
   <li>ConnectionContext</li> 
   <li>LocationService</li> 
   <li>StatusService</li> 
  </ul> 
  <p>Note that if you are using your own application loader then you should ensure that the Akka and Play ConductR-related properties are loaded. Here's a complete implementation (for Scala):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MyCustomApplicationLoader</span> <span class="pl-k">extends</span> <span class="pl-e">ApplicationLoader</span> {
  <span class="pl-k">def</span> <span class="pl-en">load</span>(<span class="pl-v">context</span>: <span class="pl-en">ApplicationLoader</span>.<span class="pl-en">Context</span>)<span class="pl-k">:</span> <span class="pl-en">Application</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">systemName</span> <span class="pl-k">=</span> <span class="pl-en">AkkaEnv</span>.mkSystemName(<span class="pl-s"><span class="pl-pds">"</span>application<span class="pl-pds">"</span></span>)
    <span class="pl-k">val</span> <span class="pl-en">conductRConfig</span> <span class="pl-k">=</span> <span class="pl-en">Configuration</span>(<span class="pl-en">AkkaEnv</span>.asConfig(systemName)) <span class="pl-k">++</span> <span class="pl-en">Configuration</span>(<span class="pl-en">PlayEnv</span>.asConfig(systemName))
    <span class="pl-k">val</span> <span class="pl-en">newConfig</span> <span class="pl-k">=</span> context.initialConfiguration <span class="pl-k">++</span> conductRConfig
    <span class="pl-k">val</span> <span class="pl-en">newContext</span> <span class="pl-k">=</span> context.copy(initialConfiguration <span class="pl-k">=</span> newConfig)
    <span class="pl-k">val</span> <span class="pl-en">prodEnv</span> <span class="pl-k">=</span> <span class="pl-en">Environment</span>.simple(mode <span class="pl-k">=</span> <span class="pl-en">Mode</span>.<span class="pl-en">Prod</span>)
    <span class="pl-k">new</span> <span class="pl-en">GuiceApplicationLoader</span>(<span class="pl-en">GuiceApplicationBuilder</span>(environment <span class="pl-k">=</span> prodEnv)).load(newContext)
  }
}</pre>
  </div> 
  <h2><a id="user-content-lagom13-java-conductr-bundle-lib" class="anchor" href="https://github.com/typesafehub/conductr-lib#lagom13-java-conductr-bundle-lib" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>lagom13-java-conductr-bundle-lib</h2> 
  <blockquote> 
   <p>If you are using Lagom 1.x with Java, then this section is for you.</p> 
  </blockquote> 
  <p><a href="https://github.com/typesafehub/sbt-conductr" target="_blank">sbt-conductr</a> automatically adds this library to your Lagom project. You don't need set any additional settings for your Lagom services.</p> 
  <p>Note that if you are using your own application loader then you should ensure that the Akka, Play and Lagom ConductR-related properties are loaded. Here's a complete implementation (in Scala):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.bundlelib.akka.</span>{ <span class="pl-v">Env</span> <span class="pl-k">=&gt;</span> <span class="pl-v">AkkaEnv</span> }
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.bundlelib.play.api.</span>{ <span class="pl-v">Env</span> <span class="pl-k">=&gt;</span> <span class="pl-v">PlayEnv</span> }
<span class="pl-k">import</span> <span class="pl-v">play.api.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">play.api.inject.guice.</span>{ <span class="pl-v">GuiceApplicationBuilder</span>, <span class="pl-v">GuiceApplicationLoader</span> }

<span class="pl-k">class</span> <span class="pl-en">MyCustomApplicationLoader</span> <span class="pl-k">extends</span> <span class="pl-e">ApplicationLoader</span> {
  <span class="pl-k">def</span> <span class="pl-en">load</span>(<span class="pl-v">context</span>: <span class="pl-en">ApplicationLoader</span>.<span class="pl-en">Context</span>)<span class="pl-k">:</span> <span class="pl-en">Application</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">systemName</span> <span class="pl-k">=</span> <span class="pl-en">AkkaEnv</span>.mkSystemName(<span class="pl-s"><span class="pl-pds">"</span>application<span class="pl-pds">"</span></span>)
    <span class="pl-k">val</span> <span class="pl-en">conductRConfig</span> <span class="pl-k">=</span> <span class="pl-en">Configuration</span>(<span class="pl-en">AkkaEnv</span>.asConfig(systemName)) <span class="pl-k">++</span> <span class="pl-en">Configuration</span>(<span class="pl-en">PlayEnv</span>.asConfig(systemName))
    <span class="pl-k">val</span> <span class="pl-en">newConfig</span> <span class="pl-k">=</span> context.initialConfiguration <span class="pl-k">++</span> conductRConfig
    <span class="pl-k">val</span> <span class="pl-en">newContext</span> <span class="pl-k">=</span> context.copy(initialConfiguration <span class="pl-k">=</span> newConfig)
    <span class="pl-k">val</span> <span class="pl-en">prodEnv</span> <span class="pl-k">=</span> <span class="pl-en">Environment</span>.simple(mode <span class="pl-k">=</span> <span class="pl-en">Mode</span>.<span class="pl-en">Prod</span>)
    <span class="pl-k">new</span> <span class="pl-en">GuiceApplicationLoader</span>(<span class="pl-en">GuiceApplicationBuilder</span>(environment <span class="pl-k">=</span> prodEnv)).load(newContext)
  }
}</pre>
  </div> 
  <h2><a id="user-content-lagom13-scala-conductr-bundle-lib" class="anchor" href="https://github.com/typesafehub/conductr-lib#lagom13-scala-conductr-bundle-lib" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>lagom13-scala-conductr-bundle-lib</h2> 
  <blockquote> 
   <p>If you are using Lagom 1.x with Scala, then this section is for you.</p> 
  </blockquote> 
  <p><a href="https://github.com/typesafehub/sbt-conductr" target="_blank">sbt-conductr</a> automatically adds this library to your Lagom project. This provides components, including the service locator and other components necessary for initialization on ConductR, which you can mix in with your application cake. To do so, mix <code>ConductRApplicationComponents</code> into your production cake:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.lightbend.lagom.scaladsl.devmode.</span><span class="pl-v">LagomDevModeComponents</span>
<span class="pl-k">import</span> <span class="pl-v">com.lightbend.lagom.scaladsl.server.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.conductr.bundlelib.lagom.scaladsl.</span><span class="pl-v">ConductRApplicationComponents</span>

<span class="pl-k">class</span> <span class="pl-en">HelloApplicationLoader</span> <span class="pl-k">extends</span> <span class="pl-e">LagomApplicationLoader</span> {

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">load</span>(<span class="pl-v">context</span>: <span class="pl-en">LagomApplicationContext</span>) <span class="pl-k">=</span>
    <span class="pl-k">new</span> <span class="pl-en">HelloApplication</span>(context) <span class="pl-k">with</span> <span class="pl-e">ConductRApplicationComponents</span>

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">loadDevMode</span>(<span class="pl-v">context</span>: <span class="pl-en">LagomApplicationContext</span>) <span class="pl-k">=</span>
    <span class="pl-k">new</span> <span class="pl-en">HelloApplication</span>(context) <span class="pl-k">with</span> <span class="pl-e">LagomDevModeComponents</span>

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">describeService</span> <span class="pl-k">=</span> <span class="pl-en">Some</span>(readDescriptor[<span class="pl-en">HelloService</span>])
}</pre>
  </div> 
  <p>Once you have added this to each of your services, you should be ready to run in ConductR. Also note that itâ€™s very important to implement the <code>describeService</code> method on <code>LagomApplicationLoader</code>, as this will ensure that the ConductR sbt tooling is able to correctly discover the Lagom service APIs offered by each service. If using a version of Lagom earlier than 1.3.6, you should implement <code>describeServices</code> (which returns <code>immutable.Seq[Descriptor]</code>) instead of <code>describeService</code>, however returning more than one service descriptor from <code>describeServices</code> is not supported by ConductR.</p> 
  <h1><a id="user-content-for-developers" class="anchor" href="https://github.com/typesafehub/conductr-lib#for-developers" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>For Developers</h1> 
  <h2><a id="user-content-releasing" class="anchor" href="https://github.com/typesafehub/conductr-lib#releasing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Releasing</h2> 
  <p>You'll need permissions to release to the typesafe.com organization at Sonatype. You will also require a PGP key.</p> 
  <p>This projects uses <code>sbt-release</code>. To release use the <code>release</code> command (no <code>+</code> required as a prefix). This will cross publish releases for Scala. Note that you will see messages like this:</p> 
  <pre><code>[trace] Stack trace suppressed: run last conductRBundleLib/*:publish for the full output.
[trace] Stack trace suppressed: run last common/*:publish for the full output.
[error] (conductRBundleLib/*:publish) java.io.IOException: destination file exists and overwrite == false
[error] (common/*:publish) java.io.IOException: destination file exists and overwrite == false
</code></pre> 
  <p>This is because the same Java libraries are used for multiple Scala versions. Do not be concerned, the publishing tool is actually just warning you i.e. they are not errors.</p> 
  <p>Everything is released to Maven Central via the Sonatype repository, including automated staging to release.</p> 
 </article>
</div>